<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kh.em.albaya.hire.model.mapper.HireMapper">
<!-- 
	<insert id="boardInsert" useGeneratedKeys="true" parameterType="Board">
		<selectKey order="BEFORE" resultType="_int" keyProperty="boardNo">
		SELECT SEQ_BOARD_NO.NEXTVAL FROM DUAL
		</selectKey>
	
		INSERT INTO "BOARD" 
		VALUES(#{boardNo}, 
				#{boardTitle},
				#{boardContent},
				DEFAULT,
				DEFAULT,
				DEFAULT,
				DEFAULT,
				#{boardCode},
				#{memberNo}
				)
	</insert>
 -->
 
 	<!-- typeName에 따른 typeNo 조회 -->
	<select id="hireTypeNo">
		SELECT TYPE_NO FROM "WORK_TYPE"
		WHERE TYPE_NAME = #{typeName}
	</select>
	
	
	<select id="selectListCount">
		SELECT COUNT(*) FROM "HIRE"
		WHERE HIRE_STATUS = 0
	</select>
	
	<!-- 기업명, 공고제목, 근무시간, 근무지역, 급여-->
	<select id="selectHireList">	
		SELECT SHOP_NAME, HIRE_TITLE, WORK_START,HIRE_NO,
		WORK_END, DOSI_NAME, SIGUNGU_NAME, PAY_NAME, PAY_INPUT
		FROM "HIRE" A
		JOIN "SHOP" B ON (B.SHOP_NO=A.SHOP_NO)
		JOIN "DONG" C ON (C.DONG_NO=A.DONG_NO)
		JOIN "SIGUNGU" D ON (D.SIGUNGU_NO=C.SIGUNGU_NO)
		JOIN "DOSI" E ON (E.DOSI_NO=D.DOSI_NO)
		JOIN "PAY_TYPE" F ON (F.PAY_NO=A.PAY_NO)
		WHERE HIRE_STATUS = 0
		ORDER BY HIRE_NO DESC
	</select>
	
	<!-- INSERT -->
	<insert id="insertWrite" useGeneratedKeys="true" parameterType="Hire">
		<selectKey order="BEFORE" resultType="_int" keyProperty="hireNo">
		SELECT SEQ_HIRE_NO.NEXTVAL FROM DUAL
		</selectKey>
	
		INSERT INTO "HIRE" 
		VALUES(
		#{hireNo},#{shopNo},#{typeNo},
		#{payNo},#{hireTitle},#{hireContent},
		DEFAULT,TO_DATE(#{hireEnd}, 'YYYY-MM-DD'),#{hireCount},
		#{hireTerm},#{hireGender},DEFAULT,
		#{workDay},#{payInput},#{dongNo},
		#{addressDetail},#{workStart},#{workEnd}
				)
	</insert>
	
	<!-- 시군구동이 모두 일치하는 동 번호 조회 -->
	<select id="hireDongNo">
	       SELECT DONG_NO
       FROM "DONG"
       JOIN "SIGUNGU" USING (SIGUNGU_NO)
       JOIN "DOSI" USING (DOSI_NO)
       WHERE REPLACE(DONG_NAME, ' ', '') LIKE '%' || REPLACE(#{dongName}, ' ', '') || '%'
       AND REPLACE(SIGUNGU_NAME, ' ', '') LIKE '%' || REPLACE(#{sigunguName}, ' ', '') || '%'
       AND REPLACE(DOSI_NAME, ' ', '') LIKE '%' || REPLACE(#{dosiName}, ' ', '') || '%'
	</select>
	
	<!-- 공고 번호, 공고제목, 공고내용, 업직종 이름, 모집인원, 
	모집종료일(2024-03-23), 근무기간(몇개월), 근무요일(월,수,금)
	근무 시작 시간, 근무 종료 시간, 급여종류명, 급여양, 모집성별,
	근무지 시군구, 근무지 상세주소, 담당자명, 담당자연락처,담당자이메일,
	
	  -->
	<!-- 공고 상세 조회 -->
	<select id="detailHire">
		SELECT 
	
	</select>
</mapper>
