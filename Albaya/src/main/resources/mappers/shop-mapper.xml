<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kh.em.albaya.shop.model.mapper.ShopMapper">

	<select id="checkEmail" resultType="_int">
		SELECT COUNT(*)
		FROM "SHOP"
		WHERE SHOP_EMAIL = #{shopEmail}
	</select>
	
	<select id="checkBrn" resultType="_int">
		SELECT COUNT(*)
		FROM "SHOP"
		WHERE SHOP_BRN = #{shopBrn}
	</select>
	
	<select id="findDongNo" resultType="_int">
		SELECT DONG_NO
		FROM "DONG"
		JOIN "SIGUNGU" USING (SIGUNGU_NO)
		JOIN "DOSI" USING (DOSI_NO)
		WHERE DONG_NAME = #{dongName}
		AND SIGUNGU_NAME LIKE '%'||#{sigunguName}||'%'
		AND DOSI_NAME LIKE '%'||#{dosiName}||'%'
	</select>
	
	<insert id="signup">
		INSERT INTO
		"SHOP" VALUES(SEQ_SHOP_NO.NEXTVAL, #{dongNo}, #{shopName},
		 #{shopEmail},#{shopPw}, #{shopTel}, #{shopBrn}, 
		 #{shopOwner}, #{shopProfile}, #{addressDetail}, SYSDATE, DEFAULT, DEFAULT)
	</insert>
</mapper>
